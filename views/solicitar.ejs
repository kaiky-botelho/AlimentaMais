<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitar Doação</title>
    <link rel="stylesheet" href="/css/solicitar.css">
</head>

<body>
    <header>
        <img class="logo" src="/img/logoV3.png" alt="Logo">
        <button class="logout"><a href="/"><img src="/img/sair.svg" alt="Sair"></a></button>
    </header>

    <div class="main-section">
        <h2 class="titulo">Solicitar Doação</h2>
        <form action="/fazerSolicitacao" method="post">
            <div class="informacao-alimento">
                <div class="form-group">
                    <label for="alimento">Alimento</label> <br>
                    <select name="solicitacao_alimento" id="solicitacao_alimento" onchange="preencherQuantidade()">
                        <option value="" disabled selected>Selecione o alimento</option>
                        <% if (doacoes.length === 0) { %>
                            <option disabled>Nenhuma doação disponível no momento</option>
                        <% } else { %>
                            <% doacoes.forEach(doacao => { %>
                                <option value="<%= doacao.doacao_alimento %>" data-qtd="<%= doacao.doacao_qtd %>"><%= doacao.doacao_alimento %></option>
                            <% }) %>
                        <% } %>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="quantidade">Quantidade ou peso em KG</label>
                    <input type="text" id="quantidade" name="solicitacao_qtd" required readonly>
                </div>
                <div class="form-group">
                    <label for="observacao">Observação</label>
                    <input type="text" id="observacao" name="solicitacao_obs">
                </div>
            </div>

            <div class="informacao-entrega">
                <div class="form-dateTime">
                    <label for="data-coleta">Data</label>
                    <input type="date" id="data-coleta" name="solicitacao_data" required>
                </div>
                <div class="form-dateTime">
                    <label for="hora-coleta">Horário</label>
                    <input type="time" id="hora-coleta" name="solicitacao_horario" required>
                </div>
            </div>

            <h2 class="titulo">Informação da Coleta</h2>
            <label>Opções de entrega</label>
            <div class="check">
                <div>
                    <input type="radio" id="retirar-endereco" name="solicitacao_entrega" value="Retirar no endereço" required checked onchange="exibir()">
                    <label for="retirar-endereco">Retirar no Local</label>
                </div>
                <div>
                    <input type="radio" id="entregar-pessoalmente" name="solicitacao_entrega" value="Entregar pessoalmente" required onchange="exibir()">
                    <label for="entregar-pessoalmente">Entregar no meu endereço</label>
                </div>
            </div>            
            <div id="resultados-radio">
                <div class="locais">
                    <h2>Locais disponíveis para retirada</h2>
                    <div class="checkbox-container">
                        <% if (doadores.length === 0) { %>
                            <p>Nenhum local de retirada disponível.</p>
                        <% } else { %>
                            <% doadores.forEach(doador => { %>
                                <div>
                                    <input type="checkbox" id="doador_<%= doador.id_doador %>" name="doador_endereco[]" value="<%= doador.doador_endereco %>">
                                    <label for="doador_<%= doador.id_doador %>"><%= doador.doador_endereco %></label>
                                </div>
                            <% }) %>
                        <% } %>
                    </div>
                </div>
                <div id="entrega-endereco" style="display:none;">
                    <h3>A entrega será realizada no seu endereço.</h3>
                </div>
            </div>

            <div class="buttons">
                <button class="voltar"><a href="/beneficiarioHome">Voltar</a></button>
                <button class="doar" type="submit">Solicitar</button>
            </div>
        </form>
    </div>

    <script src="/js/script.js"></script>

    <script>
        // Função para preencher a quantidade com base na opção selecionada
        function preencherQuantidade() {
            const select = document.getElementById('solicitacao_alimento');
            const quantidadeInput = document.getElementById('quantidade');
            const selectedOption = select.options[select.selectedIndex];
            const quantidade = selectedOption.getAttribute('data-qtd');
            quantidadeInput.value = quantidade || ''; // Se não houver quantidade, deixa em branco
        }
    </script>
</body>

</html>
